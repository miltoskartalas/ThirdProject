 
Μιλτιάδης Καρταλάς
ΑΜ: 1115201800313

Σημείωση : Δεν εχω υλοποιήσει την travelStats και την addVaccinationRecords



Επεξήγηση του functions.cpp / functions.h

Στο αρχειο αυτο έχω τις επιπλεον συναρτήσεις που χρειάζονται εκτός αυτων των δομών μου ( π.χ λίστες ) και ενα struct το threadInfo 
στο οποιο κρατάω όλες τους δείκτες των δομών ώστε να τα δώσω στα threads.

Στην εργασία αυτή χρησιμοποιώ τις ίδιες δομές με τη πρώτη. Πλέον η main της πρώτης εργασίας όπου γινόταν η επεξεργασία
του αρχειου και αρχικοποιούσα τις δομές. Γίνεται στην συνάρτηση AddToFile.

Η createMonitors είναι η συνάρτηση που καλείται απο το travelMonitor και φτιάχνει τα monitors εκέι γίνεται και το 
round robin των directories που θα εχει το καθε monitor και κανω execvp με πίνακα char** ο οποιος περιέχει όλα τα ορίσματα
που παίρνουμε απο τον χρήστη συν τα paths που θα έχει το καθε monitor

H readBloomFiltersFromMonitor είναι συνάρτηση που καλεί ο travelMonitor ώστε να διαβάσει τα bloomFilters απο τα monitor
μολις αυτα τα έχουν έτοιμα

H readStringClient είναι η συνάρτηση που χρησιμοποιει ο client για να διαβασει string απο τον server 
για αυτο χρησιμοποιω τη λιστα με τους Fds . Αντίστοιχη λογική και η readIntClient

readStringServer / readIntServer είναι συναρτήσεις που διαβάζει ο server απο τον client string και int αντίστοιχα

Η createThreads είναι η συνάρτηση η οποία φτιάχνει τα threads, ως όρισμα παιρνει το πληθος των threads που θελω να φτιάξω
το struct το οποίο έχει τους δείκτες των δομών μου, και έναν πίνακα όπου κρατάω τα pthread_t. Αυτό τον κατασκευάζω έξω,
ώστε να τον έχω και στο τέλος του προγραμμάτος όταν θέλω να κάνω exit για να κάνω join τα threads

Η pathsInDirectories είναι συνάρτηση η οποία μετράει πόσα .txt έχουν τα directories των χωρών που έχει πάρει
το καθε monitor. Δηλαδή αν ενα monitor έχει το script/input_dir/Greece & script/input_dir/Italy τη χρησιμοποιώ για να ξέρω
πόσα txt θα έχω συνολικά και απο τα δύο.

Ακόμη έχω την συνάρτηση threadFunction η οποία είναι αυτη που περνιέται ως όρισμα στη pthread_create
Επεξήγηση του Buffe.cpp / Buffer.h

O buffer μου είναι struct και έχω τις συναρτήσεις initialize, place , obtain , getPathsRead & addPathRead

Η place συνάρτηση είναι αυτη η οποία που τοποθετεί στον buffer τα paths που θα πρεπει να παρουν τα threads, για να το πετυχω 
αυτο παντα στην αρχη κανω lock mutex  και μετα σε μια while περιμένω για όσο δεν χωράει. Οταν θα βγει απο εκει παω και ανανεώνω
τα μέλη του buffer.

Η οbtain είαι αυτη που ελεγχει και τη χρησιμοποιω για οταν θελω να παρω κατι. Όσο το count <=0 δεν υπάρχει κάτι για να πάρω
ότε δεν ισχυύει αυτο κανω unlock και επιστρέφω το μονοπάτι απο την αρχη του buffer.

Μετα εχω δυο συναρτήσεις την  getPathsRead και την addPathRead . Η πρώτη μου επιστρέφει ποσα έχει διαβάσει το thread και 
η δευτερη αυξάνει αυτον τον counter δηλαδη το πόσα έχει διαβάσει. 

* Σημείωση * την ιδεα του producer την υλοποιώ στο monitorServer.cpp στις γραμμες 140-150 δηλαδή εκει καλω τη place



ΔΙΑΔΙΚΑΣΙΑ ΔΙΑΒΑΣΜΑΤΟΣ - AΠΟΣΤΟΛΗΣ BLOOMFILTERS

Απο τη μεριά του monitorServer : 

Ξεκινάω παίρνοντας για κάθε ιο το bloomfilter. Έπειτα στελνω στο travelMonitor για ποιον ιο πρόκειται να λάβει bloomfilter
Μετά ξεκινάω και παίρνω τους ακεραίους του BloomArray. Επειδη ο πινακας είναι απο ακεραίους ξεκινάω και στέλνω πρώτα όσους
μπορώ να στείλω (σε περιπτωση δηλαδη που το buffersize μου δεν ειναι πολλαπλασιο του 4) και έπειτα στέλνω οσους περισσευόυν.